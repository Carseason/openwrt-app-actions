var u=(s,l,a)=>new Promise((t,i)=>{var _=e=>{try{o(a.next(e))}catch(n){i(n)}},g=e=>{try{o(a.throw(e))}catch(n){i(n)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(_,g);o((a=a.apply(s,l)).next())});import{f as h,am as w,r as c,ae as B,af as E,a4 as p,a2 as f,al as d,a1 as y,aj as V,ak as N,_ as P,Z as T,an as j}from"./index.js?v=e3tIZDap";import{_ as q}from"./chunk.8SqVIwhS.js";import{_ as C}from"./chunk.5n0_Lv0M.js";import"./chunk.2VkDqO1d.js";import"./chunk.4l65r8M5.js";const x=s=>(V("data-v-20923aea"),s=s(),N(),s),D={class:"log-container"},F=x(()=>p("div",{class:"software-log_shade__pannel-title"},"日志记录",-1)),O=x(()=>p("div",{class:"software-log_shade__pannel-now"}," 运行过程中请勿重复运行任务 ",-1)),R={style:{margin:"1rem 0",padding:"0 1rem"}},U={class:"software-log_shade__pannel-content"},Z=h({__name:"page",setup(s){const l=w(),a=c(!0),t=l.params.id,i=c(""),_=c(""),g=c(""),o=c(0),e=c(!1),n=()=>u(this,null,function*(){yield Promise.all([I(),L()])}),I=()=>u(this,null,function*(){try{i.value=yield d.istorego.log.getLog({id:t})}catch(r){g.value=`${r}`}}),L=()=>u(this,null,function*(){const{error:r}=yield d.istorego.log.getLogStatus({id:t});r&&(m(),a.value=!1,r==="EOF"?(_.value="任务已结束",e.value=!0):_.value=r,o.value=100)});n();const v=setInterval(()=>{o.value<=99&&o.value++,n()},3e3),m=()=>{a.value=!1,v&&clearInterval(v)},$=()=>u(this,null,function*(){yield d.istorego.log.deleteLog({id:t})});return B(()=>{m(),e.value&&$()}),(r,z)=>{const k=C,S=q;return y(),E("div",D,[F,O,p("div",R,[f(k,{type:"line","show-indicator":!1,status:"warning",percentage:o.value,processing:o.value<100},null,8,["percentage","processing"])]),p("div",U,[f(S,{class:"istorego-log",loading:a.value,rows:40,log:`${i.value}
${g.value}
${_.value}`,"line-height":1.4,trim:""},null,8,["loading","log"])])])}}}),b=P(Z,[["__scopeId","data-v-20923aea"]]),Q=h({__name:"index",setup(s){const l=w();return(a,t)=>(y(),T(b,{key:`${j(l).params.id}`}))}});export{Q as default};
